<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web S3 Cleaner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}?v={{ asset_ver['styles.css'] }}" />
  </head>
  <body>
    <header id="topbar">
      <div class="brand">
        <img src="{{ url_for('static', filename='logo.svg') }}?v={{ asset_ver['logo.svg'] }}" alt="Web S3 Cleaner" class="logo" />
        <h1>Web S3 Cleaner</h1>
      </div>
      <div class="header-actions">
        <button id="menu-toggle" class="icon-btn" aria-label="Toggle menu" title="Toggle menu">â˜°</button>
        <button id="theme-toggle" class="icon-btn" aria-label="Toggle theme" title="Toggle theme">ğŸŒ“</button>
      </div>
    </header>
    <main>
      <aside id="sidebar">
        <h2><button id="home-link" class="unstyled-btn" aria-label="Go to homepage" title="Go to homepage">ğŸª£ Buckets</button> <span id="buckets-spinner" class="spinner small hidden" title="Loading"></span></h2>
        <ul id="buckets"></ul>
      </aside>
      <div id="sidebar-backdrop" aria-hidden="true"></div>
      <section id="content">
        <div id="landing" class="landing">
          <h2>ğŸª£ Your S3 Buckets</h2>
          <div class="muted">Select a bucket to browse and clean up.</div>
          <div class="help-card">
            <h3>Getting Started</h3>
            <ul class="help-list">
              <li>Choose a bucket from the grid or sidebar.</li>
              <li>Navigate folders with the breadcrumbs above the table.</li>
              <li>Use Smart cleanup to safely remove stale files and folders.</li>
              <li>Review the preview and approve deletions in batches.</li>
            </ul>
            <div class="muted">Tip: Use the theme button to switch Light/Dark/Auto.</div>
          </div>
          <div id="buckets-grid" class="buckets-grid" aria-live="polite">
            <div class="muted">Loading bucketsâ€¦</div>
          </div>
        </div>
        <div id="bucket-actions" class="hidden">
          <div class="actions-row">
            <h2 id="bucket-title"></h2>
            <span id="title-spinner" class="spinner small hidden" title="Loading"></span>
            <button id="btn-smart-cleanup">ğŸ§¹ Smart cleanup</button>
            <button id="btn-smart-cleanup-folders">ğŸ§¹ğŸ“ Folders cleanup</button>
            <button id="btn-cleanup">ğŸ§¼ Cleanup (30+ days)</button>
            <button id="btn-delete-all">ğŸ—‘ï¸ Delete ALL</button>
          </div>
          <div id="breadcrumbs"></div>
          <div id="counts" class="muted small">ğŸ“„ Files: <span id="count-files">0</span> â€¢ ğŸ“ Folders: <span id="count-folders">0</span> <span id="count-spinner" class="spinner small hidden" title="Counting"></span></div>
        </div>
        <div id="listing" class="hidden">
          <div id="listing-overlay" class="overlay hidden" aria-hidden="true">
            <div class="spinner large" aria-label="Loading"></div>
          </div>
          <table>
            <thead>
              <tr>
                <th data-sort="name">Name <span class="sort-icon"></span></th>
                <th data-sort="size">Size <span class="sort-icon"></span></th>
                <th data-sort="last_modified">Modified <span class="sort-icon"></span></th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="rows"></tbody>
          </table>
          <div id="pager">
            <button id="prev" disabled>â—€ï¸ Prev</button>
            <span id="pager-spinner" class="spinner small hidden" title="Loading page"></span>
            <button id="next" disabled>Next â–¶ï¸</button>
          </div>
        </div>
        <pre id="status"></pre>
      </section>
      <!-- Modal for preview/approval -->
      <div id="preview-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="preview-title">
        <div class="dialog" role="document">
          <div id="preview-panel">
            <div class="panel-header">
              <h3 id="preview-title">Review planned deletions</h3>
              <div class="actions">
                <label><input type="checkbox" id="select-all"> Select all</label>
                <button id="approve-selected" class="danger" disabled>Approve Selected</button>
                <button id="approve-all" class="danger" disabled>Approve All</button>
                <button id="cancel-preview">Cancel</button>
              </div>
            </div>
            <div id="preview-status" class="preview-status hidden"></div>
            <div id="preview-info" class="muted"></div>
            <div id="delete-progress" class="hidden">
              <div class="progress-row">
                <div class="progress-track"><div class="progress-bar" id="delete-progress-bar"></div></div>
                <div class="progress-text" id="delete-progress-text">0%</div>
                <button id="delete-stop" title="Stop deleting">Stop</button>
              </div>
            </div>
            <div id="preview-list" class="scroll"></div>
          </div>
        </div>
      </div>
    </main>
    <script src="{{ url_for('static', filename='app.js') }}?v={{ asset_ver['app.js'] }}"></script>
  </body>
  </html>

